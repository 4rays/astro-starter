# Internationalization (i18n) Guide

This project implements internationalization using Astro's built-in i18n routing. This guide explains how the system works and how to add or modify translations.

## Overview

The i18n system follows a simple structure:

- English is the default language without URL prefix (`/about`)
- Other languages use a prefix in the URL (`/ja/about`)
- UI text is stored in translation files
- Helper utilities manage language detection and text retrieval

## Project Structure

- `src/i18n/ui.ts` - Contains all translation strings organized by locale
- `src/i18n/utils.ts` - Utility functions for working with translations
- `src/pages/` - Default locale (English) pages
- `src/pages/ja/` - Japanese localized pages

## Usage

### Adding Translations

Add new translation strings to `src/i18n/ui.ts` for each supported language:

```typescript
export const ui = {
  en: {
    greeting: "Hello",
    "button.submit": "Submit"
    // Add your new English strings here
  },
  ja: {
    greeting: "こんにちは",
    "button.submit": "送信"
    // Add your Japanese translations here
  }
};
```

Use a structured naming pattern (e.g., `section.component.action`) for your translation keys.

### Using Translations in Components

#### In `.astro` files

```astro
---
import {getLangFromUrl, useTranslations} from "@/i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<h1>{t("greeting")}</h1>
<button>{t("button.submit")}</button>
```

#### In `.svelte` files

```svelte
<script>
  import {getLangFromUrl, useTranslations} from "@/i18n/utils";

  // Current URL needs to be passed in as a prop from an Astro component
  export let url;

  const lang = getLangFromUrl(url);
  const t = useTranslations(lang);
</script>

<h1>{t("greeting")}</h1>
```

### Creating Localized Pages

1. **Default locale (English):**
   Pages for the default locale go directly in `src/pages/`

2. **Other locales:**
   For other locales, create a directory with the locale name:
   - Japanese: `src/pages/ja/`
   - French: `src/pages/fr/` (if added in the future)

When adding a new page, create a version for each supported locale. You can copy the structure from the default locale and update the content using translation utilities.

## Language Detection and Routing

- The `getLangFromUrl(url)` utility extracts the language code from the URL
- The `useTranslations(lang)` utility returns a function to get translations
- The `getRouteFromUrl(url, lang)` utility builds URLs for different languages

## Adding a New Language

To add a new language (e.g., French):

1. Update `astro.config.mjs`:

   ```javascript
   i18n: {
     defaultLocale: "en",
     locales: ["en", "ja", "fr"], // Add the new locale
     routing: {
       prefixDefaultLocale: false
     }
   }
   ```

2. Add translations in `src/i18n/ui.ts`:

   ```typescript
   export const ui = {
     en: {
       /* existing English translations */
     },
     ja: {
       /* existing Japanese translations */
     },
     fr: {
       "common.version": "v1.0.0",
       "nav.home": "Accueil"
       // Add all French translations
     }
   };
   ```

3. Create the locale directory and pages:

   ```
   src/pages/fr/
   src/pages/fr/index.astro
   // Additional pages as needed
   ```

4. Update the `LanguageSelect` component to include the new language:
   ```typescript
   let languages = [
     {value: "en", label: "English", icon: Globe},
     {value: "ja", label: "日本語", icon: Globe},
     {value: "fr", label: "Français", icon: Globe}
   ];
   ```

## Best Practices

1. **Use semantic keys**: Use structured keys like `page.component.text` rather than the actual text
2. **Keep translations organized**: Group related translations with consistent naming patterns
3. **Provide fallbacks**: The `useTranslations` utility will fall back to English if a key is missing in the current language
4. **Separate content from code**: Extract all user-visible text to the translation files
5. **Test all locales**: Verify that your application works correctly in all supported languages
